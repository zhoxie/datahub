<configuration scan="true" scanPeriod="120 seconds">
    <property name="LOG_DIR" value="${LOG_DIR:-/tmp/datahub/logs/gms}"/>

    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36}:%L - %msg%n</pattern>
        </encoder>
        <filter class="ch.qos.logback.classic.filter.ThresholdFilter">
            <level>INFO</level>
        </filter>
    </appender>

    <appender name="MATS_ES_INFO" class="com.webex.mats.logback.ElasticAppender">
        <esURL>${ES_API_URL:-https://esaas-sjc02-dfw02-mats.webex.com/esapi}</esURL>
        <esIndex>${ES_LOG_INDEX:-mats_datahub_logs}</esIndex>
        <esUserName>${ES_USERNAME}</esUserName>
        <esPassword>${ES_PASSWORD}</esPassword>
        <intervalSecs>${ES_LOG_INTERVAL:-1}</intervalSecs>
        <hostName>${HOST_NAME}</hostName>
        <appName>${APP_NAME:-GMS}</appName>
        <filter class="ch.qos.logback.classic.filter.ThresholdFilter">
            <level>INFO</level>
        </filter>
    </appender>

    <appender name="MATS_ES_DEBUG" class="com.webex.mats.logback.ElasticAppender">
        <esURL>${ES_API_URL:-https://esaas-sjc02-dfw02-mats.webex.com/esapi}</esURL>
        <esIndex>${ES_LOG_INDEX:-mats_datahub_debug}</esIndex>
        <esUserName>${ES_USERNAME}</esUserName>
        <esPassword>${ES_PASSWORD}</esPassword>
        <intervalSecs>${ES_LOG_INTERVAL:-1}</intervalSecs>
        <hostName>${HOST_NAME}</hostName>
        <appName>${APP_NAME:-GMS}</appName>
        <filter class="ch.qos.logback.classic.filter.LevelFilter">
            <level>DEBUG</level>
            <onMatch>ACCEPT</onMatch>
            <onMismatch>DENY</onMismatch>
        </filter>
    </appender>

    <appender name="MATS_WEBEX" class="com.webex.mats.logback.WebexAlertAppender">
        <messageApiURL>${WBX_API:-https://api.ciscospark.com/v1/messages}</messageApiURL>
        <roomId>${WBX_ROOM_ID:-Y2lzY29zcGFyazovL3VzL1JPT00vMWYzMmFmNzAtYWZmMC0xMWVjLTg2ZjItM2ZjOTc3ZWMyYzQx}</roomId>
        <kibanaLink>${WBX_KIBANA_LINK:-https://esaas-sjc02-dfw02-mats.webex.com/mats/goto/b49606b2711375e26cf431378a543266}</kibanaLink>
        <alertPersonEmail>${WBX_ALERT_EMAIL:-zhoxie@cisco.com}</alertPersonEmail>
        <botBearToken>${WBX_BOT_TOKEN:-ZTU5NzM1ZTAtNzY4My00NjY0LTlkNjktNmQ4ZTg2Y2ZmMWRkZDYyY2EyMjctODQ4_PF84_1eb65fdf-9643-417f-9974-ad72cae0e10f}</botBearToken>
        <intervalMins>${WBX_ALERT_INTERVAL:-30}</intervalMins>
        <hostName>${HOST_NAME}</hostName>
        <messageExclusionPattern>${WBX_ALERT_EXCLUSION_PATTERN:-Unable to renew the session.*}</messageExclusionPattern>
        <filter class="ch.qos.logback.classic.filter.LevelFilter">
            <level>ERROR</level>
            <onMatch>ACCEPT</onMatch>
            <onMismatch>DENY</onMismatch>
        </filter>
    </appender>

    <!-- Remove this to disable logging debug -->
<!--    <logger name="com.linkedin" level="DEBUG">-->
<!--        <appender-ref ref="DEBUG_FILE"/>-->
<!--        <appender-ref ref="MATS_ES"/>-->
<!--        <appender-ref ref="MATS_WEBEX"/>-->
<!--    </logger>-->

<!--    <logger name="org.apache.kafka.clients" level="INFO">-->
<!--        <appender-ref ref="STDOUT" />-->
<!--        <appender-ref ref="MATS_ES"/>-->
<!--        <appender-ref ref="MATS_WEBEX"/>-->
<!--    </logger>-->

<!--    <logger name="org.reflections.Reflections" level="ERROR">-->
<!--        <appender-ref ref="STDOUT" />-->
<!--        <appender-ref ref="MATS_ES"/>-->
<!--        <appender-ref ref="MATS_WEBEX"/>-->
<!--    </logger>-->

<!--    <logger name="com.linkedin.metadata.models.registry.PatchEntityRegistry" level="INFO">-->
<!--        <appender-ref ref="STDOUT" />-->
<!--        <appender-ref ref="MATS_ES"/>-->
<!--        <appender-ref ref="MATS_WEBEX"/>-->
<!--    </logger>-->


    <root level="DEBUG">
        <appender-ref ref="MATS_ES_DEBUG"/>
        <appender-ref ref="STDOUT"/>
        <appender-ref ref="MATS_ES_INFO"/>
        <appender-ref ref="MATS_WEBEX"/>
    </root>
</configuration>
